<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Genlater</title>
</head>
<!-- logic complete design incompleted -->
<body>
    <p>Genlate Password</p>

    <div style="display: flex;">
        <p>Select password length </p>
        <select id="password_length">
        </select>
    </div>
    <div style="display: flex;">
        <input type="checkbox" id="uppercase">
        <p>I want Uppercase character in my Password.</p>
    </div>
    <div style="display: flex;">
        <input type="checkbox" id="lowercase">
        <p>I want Lowercase character in my Password.</p>
    </div>
    <div style="display: flex;">
        <input type="checkbox" id="number">
        <p>I want Numbers in my Password.</p>
    </div>
    <div style="display: flex;">
        <input type="checkbox" id="symbol">
        <p>I want Special symbols in my Password.</p>
    </div>
    <p>You password is : <span id="dis_pass"></span></p>
    <button onclick="createPassword()">Create Password</button>
    <button onclick="copy_pass()">Copy</button>

    <script>
        class Password {
            constructor(uppercase, lowercase, numbers, symbol, password_length) {
                this.password = ''

                this.uppercase_bool = uppercase
                this.lowercase_bool = lowercase
                this.number_bool = numbers
                this.symbol_bool = symbol
                this.password_length = password_length

                // AltGr+4 -> ₹
                // \\ -> \
                // \" -> "
                this.uppercase_letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
                this.lowercase_letters = "abcdefghijklmnopqrstuvwxyz"
                this.number_letters = "0123456789"
                this.symbol_letters = "`₹~!@#$%^&*()_+=[]{};'\\|:/.,<>?\""

                // this block create a random number for uppercase and lower case both
                this.upper_lower_case_range = {
                    min: Math.ceil(0),
                    max: Math.floor(25),
                    create: () => {
                        return Math.floor(Math.random() * (this.upper_lower_case_range.max - this.upper_lower_case_range.min + 1) + this.upper_lower_case_range.min)
                    }
                }

                // this block create a random number for numbers
                this.number_range = {
                    min: Math.ceil(0),
                    max: Math.floor(9),
                    create: () => {
                        return Math.floor(Math.random() * (this.number_range.max - this.number_range.min + 1) + this.number_range.min)
                    }
                }

                // this block create a random number for symbols
                this.symbol_range = {
                    min: Math.ceil(0),
                    max: Math.floor(this.symbol_letters.length - 1),
                    create: () => {
                        return Math.floor(Math.random() * (this.symbol_range.max - this.symbol_range.min + 1) + this.symbol_range.min)
                    }
                }
            }
            createPassword() {

                let key_arr = []
                let index = 0
                if (uppercase_bool) {
                    key_arr[index] = "uppercase"
                    index = index + 1
                }
                if (lowercase_bool) {
                    key_arr[index] = "lowercase"
                    index = index + 1
                }
                if (number_bool) {
                    key_arr[index] = "number"
                    index = index + 1
                }
                if (symbol_bool) {
                    key_arr[index] = "symbol"
                    index = index + 1
                }

                let i = 0
                while (i < this.password_length) {
                    let random_letter_key = Math.floor(Math.random() * (Math.floor(key_arr.length - 1) - Math.ceil(0) + 1) + Math.ceil(0))

                    if (key_arr[random_letter_key] == 'uppercase') {
                        this.password = this.password + this.uppercase_letters.charAt(this.upper_lower_case_range.create())
                    }

                    if (key_arr[random_letter_key] == 'lowercase') {
                        this.password = this.password + this.lowercase_letters.charAt(this.upper_lower_case_range.create())
                    }

                    if (key_arr[random_letter_key] == 'number') {
                        this.password = this.password + this.number_letters.charAt(this.number_range.create())
                    }

                    if (key_arr[random_letter_key] == 'symbol') {
                        this.password = this.password + this.symbol_letters.charAt(this.symbol_range.create())
                    }
                    i = i + 1
                }

                console.log("1password is : ", this.password);
                // make regex expression to check a category miss randomly and add it on random place
                let final_upper_check = false
                let final_lower_check = false
                let final_number_check = false
                let final_symbol_check = false
                let end_check = false
                let b = 0

                // this while loop help to add missing charcter then ask by user
                // while (!(final_upper_check)) {
                while (!(final_upper_check && final_lower_check && final_number_check && final_symbol_check && end_check)) {
                    // console.log("Condition : ",(final_upper_check && final_lower_check && final_number_check && final_symbol_check && end_check));

                    key_arr.forEach((Element) => {

                        // at least one upper case check 
                        if (Element == 'uppercase') {
                            if (!/[A-Z]/.test(this.password)) {
                                console.log("upper not exits");
                                let random_position = Math.floor(Math.random() * (Math.floor(this.password.length - 1) - Math.ceil(0) + 1) + Math.ceil(0))
                                let random_char = this.uppercase_letters.charAt(this.upper_lower_case_range.create())

                                const password_arr = this.password.split('')
                                password_arr[random_position] = random_char
                                this.password = password_arr.join('')
                                final_upper_check = true
                            } else {
                                final_upper_check = true
                            }
                        } else {
                            final_upper_check = true
                        }

                        // at least one lower case check 
                        if (Element == 'lowercase') {
                            if (!/[a-z]/.test(this.password)) {
                                console.log("lower not exits");
                                let random_position = Math.floor(Math.random() * (Math.floor(this.password.length - 1) - Math.ceil(0) + 1) + Math.ceil(0))
                                let random_char = this.lowercase_letters.charAt(this.upper_lower_case_range.create())

                                const password_arr = this.password.split('')
                                password_arr[random_position] = random_char
                                this.password = password_arr.join('')
                                final_lower_check = true
                            } else {
                                final_lower_check = true
                            }
                        } else {
                            final_lower_check = true
                        }

                        // at least one number check 
                        if (Element == 'number') {
                            if (!/[0-9]/.test(this.password)) {
                                console.log("number not exits");
                                let random_position = Math.floor(Math.random() * (Math.floor(this.password.length - 1) - Math.ceil(0) + 1) + Math.ceil(0))
                                let random_char = this.number_letters.charAt(this.number_range.create())

                                const password_arr = this.password.split('')
                                password_arr[random_position] = random_char
                                this.password = password_arr.join('')
                                final_number_check = true
                            } else {
                                final_number_check = true
                            }
                        } else {
                            final_number_check = true
                        }

                        // at least one symbol check 
                        if (Element == 'symbol') {
                            if (!/[^A-Za-z0-9]/.test(this.password)) {
                                console.log("symbol not exits");
                                let random_position = Math.floor(Math.random() * (Math.floor(this.password.length - 1) - Math.ceil(0) + 1) + Math.ceil(0))
                                let random_char = this.symbol_letters.charAt(this.symbol_range.create())

                                const password_arr = this.password.split('')
                                password_arr[random_position] = random_char
                                this.password = password_arr.join('')
                                final_symbol_check = true
                            } else {
                                final_symbol_check = true
                            }
                        } else {
                            final_symbol_check = true
                        }
                    })

                    // this if block responsible for infinite loop but this also help to break the while loop
                    if (!/[^A-Za-z0-9]/.test(this.password) || !/[0-9]/.test(this.password) || !/[a-z]/.test(this.password) || !/[A-Z]/.test(this.password)) {
                        end_check = false
                        // infintie loop occur in this block
                    } else {
                        end_check = true
                        // this block help to break while loop
                    }

                    console.log("Re-created password is : ", this.password);
                    // i will break this infinite loop after itreation 10 (infinite loop occur because else block never execute )
                    b = b + 1
                    if (b == 10) {
                        break
                    }
                }
                console.log("final password is : ", this.password);
                return this.password
            }
        }

        let uppercase = document.getElementById('uppercase')
        let lowercase = document.getElementById('lowercase')
        let number = document.getElementById('number')
        let symbol = document.getElementById('symbol')
        let select = document.getElementById('password_length')
        let dis_pass = document.getElementById('dis_pass')

        let uppercase_bool = false
        let lowercase_bool = false
        let number_bool = false
        let symbol_bool = false

        uppercase.addEventListener('click', () => {
            console.log(uppercase.checked);
            uppercase_bool = uppercase.checked
        })
        lowercase.addEventListener('click', () => {
            console.log(lowercase.checked);
            lowercase_bool = lowercase.checked
        })
        number.addEventListener('click', () => {
            console.log(number.checked);
            number_bool = number.checked
        })
        symbol.addEventListener('click', () => {
            console.log(symbol.checked);
            symbol_bool = symbol.checked
        })

        let passObj, password
        createPassword = () => {
            if (uppercase_bool || lowercase_bool || number_bool || symbol_bool) {
                console.log("password created");
                passObj = new Password(uppercase_bool, lowercase_bool, number_bool, symbol_bool, select.value)
                password = passObj.createPassword()
                dis_pass.innerText = password
            } else {
                console.log("at least one checkbox will be checked!");
            }
        }

        // create options for password length
        for (let i = 4; i < 31; i++) {
            let optionElement = document.createElement('option')
            optionElement.value = i
            optionElement.innerText = i
            select.appendChild(optionElement)
        }

        // copy password to clipboard
        copy_pass=()=>{
            navigator.clipboard.writeText(password);
        }
    </script>
</body>

</html>